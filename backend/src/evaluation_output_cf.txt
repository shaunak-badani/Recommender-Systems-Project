Starting Item-Item CF evaluation (k=10, threshold=4.0)...
Loading review data...
Loaded 561479 reviews.
561479 reviews after NaN drop.
Loading business data...
Loaded 84551 businesses.
Building restaurant category embeddings...
/home/shaunak/.virtualenvs/recommenders/lib/python3.10/site-packages/sklearn/feature_extraction/text.py:517: UserWarning: The parameter 'token_pattern' will not be used since 'tokenizer' is not None'
  warnings.warn(
Embeddings built and normalized.

--- Using the full dataset ---

Splitting ratings into train/test (80%/20%)...
Warning: Stratify failed (The least populated class in y has only 1 member, which is too few. The minimum number of groups for any class cannot be less than 2.). Splitting without stratify.
Train ratings: 449183, Test ratings: 112296
Instantiating CollaborativeRecommender...
Evaluating users found in the test set...
Found 54752 users with relevant items (rating >= 4.0) in test set.
...processed 1000/54752 users.
...processed 3000/54752 users.
...processed 4000/54752 users.
...processed 5000/54752 users.
...processed 6000/54752 users.
...processed 7000/54752 users.
...processed 8000/54752 users.
...processed 9000/54752 users.
...processed 14000/54752 users.
...processed 15000/54752 users.
...processed 16000/54752 users.
...processed 17000/54752 users.
...processed 18000/54752 users.
...processed 19000/54752 users.
...processed 20000/54752 users.
...processed 22000/54752 users.
...processed 23000/54752 users.
...processed 24000/54752 users.
...processed 25000/54752 users.
...processed 26000/54752 users.
...processed 28000/54752 users.
...processed 30000/54752 users.
...processed 32000/54752 users.
...processed 33000/54752 users.
...processed 35000/54752 users.
...processed 36000/54752 users.
...processed 40000/54752 users.
...processed 42000/54752 users.
...processed 43000/54752 users.
...processed 46000/54752 users.
...processed 49000/54752 users.
...processed 50000/54752 users.
...processed 51000/54752 users.
...processed 52000/54752 users.
Finished evaluating 29737 users (recommendations generated).

--- Item-Item Collaborative Filtering Evaluation Results ---
Dataset Used: Full (561479 reviews)
Train Reviews: 449183, Test Reviews: 112296
Users w/ Relevant Test Items: 54752
Users Evaluated (Recs Generated): 29737
User Coverage (Evaluated / Total w/ Relevant): 54.31%

Ranking Metrics (k=10, relevance_threshold=4.0):
  MRR:         0.0009
  NDCG@10:     0.0009
  Precision@10:0.0002
  Recall@10:   0.0016

Total evaluation time: 5241.93 seconds.
-------------------------------------------------
